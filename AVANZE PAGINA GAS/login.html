<!DOCTYPE html>


<html lang="es">


<head>
    <meta charset="UTF-8">
    <title>Iniciar sesión</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>



<body class="bg-light">



    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-4">

                <div class="card p-4">
                    <h4 class="text-center mb-3">Inicio de sesión</h4>

                    <input type="text" id="usuario" class="form-control mb-2" placeholder="Usuario">
                    <input type="password" id="clave" class="form-control mb-3" placeholder="Contraseña">

                    <button class="btn btn-primary w-100" onclick="login()">
                        Ingresar
                    </button>

                    <div class="mt-3 text-center">
                        <p>¿No tienes cuenta? <a href="registro.html">Regístrate aquí</a></p>
                    </div>
                
                <div class="mt-3 text-center">
                        <p><a href="index.html">Ingresar como Invitado</a></p>
                    </div>
            </div>
        </div>
    </div>



    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        function login() {
            let usuarioIngresado = document.getElementById("usuario").value;
            let claveIngresada = document.getElementById("clave").value;

            //el ADMINISTRADOR Siempre entra igual
            if (usuarioIngresado === "admin" && claveIngresada === "1234") {
                localStorage.setItem("rol", "admin");
                window.location.href = "admin.html";
                return;
            }


            // Traemos la lista de usuarios guardados en el registro
            let listaUsuarios = JSON.parse(localStorage.getItem("listaUsuarios")) || [];

            let usuarioEncontrado = false;

            // Buscamos si el usuario y la clave coinciden con alguien de la lista
            for (let i = 0; i < listaUsuarios.length; i++) {
                let u = listaUsuarios[i];
                if (u.usuario === usuarioIngresado && u.clave === claveIngresada) {
                    usuarioEncontrado = true;
                    break;
                }
            }

            // También dejamos entrar al usuario de prueba 'cliente' / '1234'
            if (usuarioEncontrado === true || (usuarioIngresado === "cliente" && claveIngresada === "1234")) {
                localStorage.setItem("rol", "cliente");
                // Guardamos el nombre para saludarlo después (Opcional pero bonito)
                localStorage.setItem("usuarioActual", usuarioIngresado);
                window.location.href = "index.html";
            } else {
                Swal.fire("Error", "Usuario o contraseña incorrectos", "error");
            }
        }
    </script>

</body>

</html>